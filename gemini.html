<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Vibration Inspection</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dashboard-container {
            padding: 20px;
        }
        .data-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #fff; /* Default light mode background */
            color: #212529; /* Default light mode text color */
        }
        .chart-container {
            margin-bottom: 20px;
        }
        body {
            background-color: #f8f9fa; /* Default light mode body background */
            color: #212529; /* Default light mode body text color */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .btn-toggle-mode {
            margin-bottom: 15px;
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #343a40;
            color: #f8f9fa;
        }
        .data-card.dark-mode {
            background-color: #495057;
            border-color: #6c757d;
            color: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container dashboard-container">
        <div class="d-flex justify-content-end mb-3">
            <button class="btn btn-outline-dark btn-sm btn-toggle-mode" onclick="toggleDarkMode()">Toggle Dark Mode</button>
        </div>

        <h1 class="mb-4">Tree Vibration Inspection Dashboard</h1>

        <div class="row">
            <div class="col-md-6">
                <div class="data-card">
                    <h3>Not Infected Tree Vibration Data</h3>
                    <canvas id="notInfectedChart"></canvas>
                    <ul class="list-unstyled mt-3">
                        <li><strong>Average Vibration:</strong> <span id="notInfectedAvg">-</span></li>
                        <li><strong>Minimum Vibration:</strong> <span id="notInfectedMin">-</span></li>
                        <li><strong>Maximum Vibration:</strong> <span id="notInfectedMax">-</span></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-6">
                <div class="data-card">
                    <h3>Infected Tree Vibration Data</h3>
                    <canvas id="infectedChart"></canvas>
                    <ul class="list-unstyled mt-3">
                        <li><strong>Average Vibration:</strong> <span id="infectedAvg">-</span></li>
                        <li><strong>Minimum Vibration:</strong> <span id="infectedMin">-</span></li>
                        <li><strong>Maximum Vibration:</strong> <span id="infectedMax">-</span></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="data-card">
                    <h3>Comparison of Vibration Over Time</h3>
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get references to elements we'll need to toggle
        const body = document.body;
        const dataCards = document.querySelectorAll('.data-card');
        const bootstrapCSS = document.getElementById('bootstrap-css');

        function enableDarkMode() {
            body.classList.add('dark-mode');
            dataCards.forEach(card => card.classList.add('dark-mode'));
            // Consider swapping to a dark mode Bootstrap theme if you have one
            // bootstrapCSS.href = 'path/to/bootstrap-dark.min.css';
            localStorage.setItem('theme', 'dark');
        }

        function enableLightMode() {
            body.classList.remove('dark-mode');
            dataCards.forEach(card => card.classList.remove('dark-mode'));
            bootstrapCSS.href = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css';
            localStorage.setItem('theme', 'light');
        }

        function toggleDarkMode() {
            if (body.classList.contains('dark-mode')) {
                enableLightMode();
            } else {
                enableDarkMode();
            }
        }

        // Check for saved theme preference on page load
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            enableDarkMode();
        }

        // Not Infected Data
        const notInfectedRawData = `
0000s: -0.961342
0001s: -0.961582
0002s: -0.961510
0003s: -0.961723
0004s: -0.961340
0005s: -0.961291
0006s: -0.965396
0007s: -0.963285
0008s: -0.963798
0009s: -0.963716
0010s: -0.963834
0011s: -0.965018
0012s: -0.964408
0013s: -0.965779
0014s: -0.965287
0015s: -0.969484
0016s: -0.977265
0017s: -0.977624
0018s: -0.976998
0019s: -0.977545
0020s: -0.977701
0021s: -0.977323
0022s: -0.977748
0023s: -0.977939
0024s: -0.978179
0025s: -0.978536
0026s: -0.978590
0027s: -0.978088
0028s: -0.978096
0029s: -0.978831
0030s: -0.978016
0031s: -0.977837
0032s: -0.977601
0033s: -0.977659
0034s: -0.978176
0035s: -0.977825
0036s: -0.978288
0037s: -0.978081
0038s: -0.978436
0039s: -0.978200
0040s: -0.978858
0041s: -0.978826
0042s: -0.978839
0043s: -0.978397
0044s: -0.979194
0045s: -0.979046
0046s: -0.978442
0047s: -0.978386
0048s: -0.978507
0049s: -0.977637
0050s: -0.978022
0051s: -0.978165
0052s: -0.978607
0053s: -0.978713
0054s: -0.979243
0055s: -0.978908
0056s: -0.979276
0057s: -0.979454
0058s: -0.979602
0059s: -0.979621
0060s: -0.979480
0061s: -0.978837
0062s: -0.982715
0063s: -0.984349
0064s: -0.982845
0065s: -0.982009
0066s: -0.983100
0067s: -0.985566
0068s: -0.983877
0069s: -0.982207
0070s: -0.985524
0071s: -0.989482
0072s: -0.984126
0073s: -0.983999
0074s: -0.986133
0075s: -0.992634
0076s: -0.985356

        `;
        const notInfectedData = notInfectedRawData.trim().split('\n').map(line => {
            const [time, value] = line.split(': ');
            return { time, value: parseFloat(value) };
        });
        const notInfectedValues = notInfectedData.map(item => item.value);
        const notInfectedTimes = notInfectedData.map(item => item.time);
        const notInfectedAvg = notInfectedValues.reduce((a, b) => a + b, 0) / notInfectedValues.length;
        const notInfectedMin = Math.min(...notInfectedValues);
        const notInfectedMax = Math.max(...notInfectedValues);
        document.getElementById('notInfectedAvg').textContent = notInfectedAvg.toFixed(6);
        document.getElementById('notInfectedMin').textContent = notInfectedMin.toFixed(6);
        document.getElementById('notInfectedMax').textContent = notInfectedMax.toFixed(6);

        // Infected Data
        const infectedRawData = `
0000s: -0.992615
0001s: -0.991534
0002s: -0.985758
0003s: -0.928748
0004s: -0.724313
0005s: -0.739197
0006s: -0.748049
0007s: -0.759460
0008s: -0.770177
0009s: -0.776260
0010s: -0.784192
0011s: -0.793609
0012s: -0.798470
0013s: -0.806228
0014s: -0.815476
0015s: -0.886771
0016s: -0.986599
0017s: -0.985933
0018s: -0.989220
0019s: -0.991628
0020s: -0.990726
0021s: -0.990421
0022s: -0.993777
0023s: -0.990986
0024s: -0.993334
0025s: -0.993675
0026s: -0.991953
0027s: -0.994820
0028s: -0.995154
0029s: -0.996166
0030s: -0.996414
0031s: -0.998881
0032s: -0.999842
0033s: -0.999863
0034s: -0.999849
0035s: -0.999863
0036s: -0.999706
0037s: -0.999467
0038s: -0.999847
0039s: -0.999887
0040s: -0.999920
0041s: -0.999886
0042s: -0.999938
0043s: -0.999923
0044s: -0.999931
0045s: -0.999939
0046s: -0.996363
0047s: -0.983145
0048s: -0.983270
0049s: -0.982461
0050s: -0.982988
0051s: -0.983007
0052s: -0.982482
0053s: -0.982858
0054s: -0.983119
0055s: -0.982515
0056s: -0.983066
0057s: -0.983371
0058s: -0.982998
0059s: -0.982752
0060s: -0.983425
0061s: -0.983254
0062s: -0.986918
0063s: -0.985891
0064s: -0.990028
0065s: -0.985188
0066s: -0.986147
0067s: -1.000000
0068s: -0.999988
0069s: -0.999464
0070s: -0.998954
0071s: -0.996003
0072s: -0.993914
0073s: -0.994797
0074s: -0.994889
0075s: -0.994905
0076s: -0.994798
        `;
        const infectedData = infectedRawData.trim().split('\n').map(line => {
            const [time, value] = line.split(': ');
            return { time, value: parseFloat(value) };
        });
        const infectedValues = infectedData.map(item => item.value);
        const infectedTimes = infectedData.map(item => item.time);
        const infectedAvg = infectedValues.reduce((a, b) => a + b, 0) / infectedValues.length;
        const infectedMin = Math.min(...infectedValues);
        const infectedMax = Math.max(...infectedValues);
        document.getElementById('infectedAvg').textContent = infectedAvg.toFixed(6);
        document.getElementById('infectedMin').textContent = infectedMin.toFixed(6);
        document.getElementById('infectedMax').textContent = infectedMax.toFixed(6);

        // Chart 1: Not Infected
        const notInfectedCtx = document.getElementById('notInfectedChart').getContext('2d');
        new Chart(notInfectedCtx, {
            type: 'line',
            data: {
                labels: notInfectedTimes,
                datasets: [{
                    label: 'Vibration',
                    data: notInfectedValues,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Vibration Value'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Time (s)'
                        }
                    }
                }
            }
        });

        // Chart 2: Infected
        const infectedCtx = document.getElementById('infectedChart').getContext('2d');
        new Chart(infectedCtx, {
            type: 'line',
            data: {
                labels: infectedTimes,
                datasets: [{
                    label: 'Vibration',
                    data: infectedValues,
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Vibration Value'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Time (s)'
                        }
                    }
                }
            }
        });

        // Chart 3: Comparison
        const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
        new Chart(comparisonCtx, {
            type: 'line',
            data: {
                labels: [...new Set([...notInfectedTimes, ...infectedTimes])].sort(), // Combine and sort times
                datasets: [
                    {
                        label: 'Not Infected',
                        data: notInfectedData.reduce((acc, curr) => {
                            acc[curr.time] = curr.value;
                            return acc;
                        }, {}),
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Infected',
                        data: infectedData.reduce((acc, curr) => {
                            acc[curr.time] = curr.value;
                            return acc;
                        }, {}),
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Vibration Value'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Time (s)'
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                }
            }
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>