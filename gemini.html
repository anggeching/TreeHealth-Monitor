<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Vibration Inspection</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dashboard-container {
            padding: 20px;
        }
        .data-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #fff; /* Default light mode background */
            color: #212529; /* Default light mode text color */
        }
        .chart-container {
            margin-bottom: 20px;
        }
        body {
            background-color: #f8f9fa; /* Default light mode body background */
            color: #212529; /* Default light mode body text color */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .btn-toggle-mode {
            margin-bottom: 15px;
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #343a40;
            color: #f8f9fa;
        }
        .data-card.dark-mode {
            background-color: #495057;
            border-color: #6c757d;
            color: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container dashboard-container">
        <div class="d-flex justify-content-end mb-3">
            <button class="btn btn-outline-dark btn-sm btn-toggle-mode" onclick="toggleDarkMode()">Toggle Dark Mode</button>
        </div>

        <h1 class="mb-4">Tree Vibration Inspection Dashboard</h1>

        <div class="row">
            <div class="col-md-6">
                <div class="data-card">
                    <h3>Not Infected Tree Vibration Data</h3>
                    <canvas id="notInfectedChart"></canvas>
                    <ul class="list-unstyled mt-3">
                        <li><strong>Average Vibration:</strong> <span id="notInfectedAvg">-</span></li>
                        <li><strong>Minimum Vibration:</strong> <span id="notInfectedMin">-</span></li>
                        <li><strong>Maximum Vibration:</strong> <span id="notInfectedMax">-</span></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-6">
                <div class="data-card">
                    <h3>Infected Tree Vibration Data</h3>
                    <canvas id="infectedChart"></canvas>
                    <ul class="list-unstyled mt-3">
                        <li><strong>Average Vibration:</strong> <span id="infectedAvg">-</span></li>
                        <li><strong>Minimum Vibration:</strong> <span id="infectedMin">-</span></li>
                        <li><strong>Maximum Vibration:</strong> <span id="infectedMax">-</span></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="data-card">
                    <h3>Comparison of Vibration Over Time</h3>
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get references to elements we'll need to toggle
        const body = document.body;
        const dataCards = document.querySelectorAll('.data-card');
        const bootstrapCSS = document.getElementById('bootstrap-css');

        function enableDarkMode() {
            body.classList.add('dark-mode');
            dataCards.forEach(card => card.classList.add('dark-mode'));
            // Consider swapping to a dark mode Bootstrap theme if you have one
            // bootstrapCSS.href = 'path/to/bootstrap-dark.min.css';
            localStorage.setItem('theme', 'dark');
        }

        function enableLightMode() {
            body.classList.remove('dark-mode');
            dataCards.forEach(card => card.classList.remove('dark-mode'));
            bootstrapCSS.href = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css';
            localStorage.setItem('theme', 'light');
        }

        function toggleDarkMode() {
            if (body.classList.contains('dark-mode')) {
                enableLightMode();
            } else {
                enableDarkMode();
            }
        }

        // Check for saved theme preference on page load
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            enableDarkMode();
        }

        // Not Infected Data
        const notInfectedRawData = `
0000s: -0.961344
0001s: -0.961597
0002s: -0.961525
0003s: -0.961739
0004s: -0.961354
0005s: -0.961340
0006s: -0.965418
0007s: -0.963300
0008s: -0.963808
0009s: -0.963719
0010s: -0.963851
0011s: -0.965026
0012s: -0.964446
0013s: -0.965786
0014s: -0.965304
0015s: -0.964718
0016s: -0.961654
0017s: -0.961241
0018s: -0.961948
0019s: -0.961304
0020s: -0.961530
0021s: -0.963077
0022s: -0.964360
0023s: -0.963420
0024s: -0.963769
0025s: -0.963560
0026s: -0.964639
0027s: -0.964457
0028s: -0.964557
0029s: -0.966118
0030s: -0.965591
0031s: -0.963201
0032s: -0.961457
0033s: -0.961535
0034s: -0.961688
0035s: -0.961497
0036s: -0.961539
0037s: -0.964309
0038s: -0.963699
0039s: -0.963570
0040s: -0.963604
0041s: -0.963641
0042s: -0.964509
0043s: -0.964849
0044s: -0.965200
0045s: -0.965559
0046s: -0.966129
0047s: -0.961770
0048s: -0.961570
0049s: -0.961566
0050s: -0.961721
0051s: -0.961379
0052s: -0.960889
0053s: -0.965594
0054s: -0.963357
0055s: -0.963758
0056s: -0.963670
0057s: -0.963793
0058s: -0.964952
0059s: -0.964231
0060s: -0.965989
0061s: -0.965301
0062s: -0.965201
0063s: -0.961618
0064s: -0.961269
0065s: -0.961947
0066s: -0.961295
0067s: -0.961613
0068s: -0.962670
0069s: -0.964607
0070s: -0.963266
0071s: -0.963926
0072s: -0.963389
0073s: -0.964030
0074s: -0.965061
0075s: -0.964484
0076s: -0.966070
0077s: -0.965563
0078s: -0.963581
0079s: -0.961897
0080s: -0.961150
0081s: -0.961959
0082s: -0.961220
0083s: -0.961334
0084s: -0.964121
0085s: -0.963793
0086s: -0.963409
0087s: -0.963613
0088s: -0.963717
0089s: -0.964640
0090s: -0.964595
0091s: -0.965231
0092s: -0.965574
0093s: -0.966101
0094s: -0.962245
0095s: -0.961497
0096s: -0.961664
0097s: -0.961629
0098s: -0.961377
0099s: -0.960809
0100s: -0.965427
0101s: -0.963516
0102s: -0.963585
0103s: -0.963682
0104s: -0.963716
0105s: -0.964888
0106s: -0.964383
0107s: -0.965843
0108s: -0.965748
0109s: -0.965250
0110s: -0.961573
0111s: -0.961302
0112s: -0.961839
0113s: -0.961363
0114s: -0.961656
0115s: -0.962163
0116s: -0.964443
0117s: -0.963556
0118s: -0.963556
0119s: -0.963821
0120s: -0.963907
0121s: -0.965056
0122s: -0.964584
0123s: -0.965952
0124s: -0.965511
0125s: -0.963968
0126s: -0.961948
0127s: -0.961137
0128s: -0.961888
0129s: -0.961209
0130s: -0.961349
0131s: -0.963857
0132s: -0.963826
0133s: -0.963300
0134s: -0.963753
0135s: -0.963714
0136s: -0.964523
0137s: -0.964611
0138s: -0.965248
0139s: -0.965651
0140s: -0.965975
0141s: -0.962673
0142s: -0.961477
0143s: -0.961579
0144s: -0.961685
0145s: -0.961381
0146s: -0.960947
0147s: -0.965065
0148s: -0.963527
0149s: -0.963557
0150s: -0.963772
0151s: -0.963580
0152s: -0.964842
0153s: -0.964840
0154s: -0.965447
0155s: -0.965677
0156s: -0.965679
0157s: -0.961508
0158s: -0.961344
0159s: -0.961442
0160s: -0.961704
0161s: -0.961240
0162s: -0.961882
0163s: -0.965012
0164s: -0.963371
0165s: -0.963751
0166s: -0.963775
0167s: -0.963883
0168s: -0.965069
0169s: -0.964578
0170s: -0.965833
0171s: -0.965434
0172s: -0.969900
0173s: -0.965304
0174s: -0.964718
0175s: -0.961654
0176s: -0.961241
0177s: -0.961948
0178s: -0.961304
0179s: -0.961530
0180s: -0.963077
        `;
        const notInfectedData = notInfectedRawData.trim().split('\n').map(line => {
            const [time, value] = line.split(': ');
            return { time, value: parseFloat(value) };
        });
        const notInfectedValues = notInfectedData.map(item => item.value);
        const notInfectedTimes = notInfectedData.map(item => item.time);
        const notInfectedAvg = notInfectedValues.reduce((a, b) => a + b, 0) / notInfectedValues.length;
        const notInfectedMin = Math.min(...notInfectedValues);
        const notInfectedMax = Math.max(...notInfectedValues);
        document.getElementById('notInfectedAvg').textContent = notInfectedAvg.toFixed(6);
        document.getElementById('notInfectedMin').textContent = notInfectedMin.toFixed(6);
        document.getElementById('notInfectedMax').textContent = notInfectedMax.toFixed(6);

        // Infected Data
        const infectedRawData = `
0003s: -0.961344  
0004s: -0.961597  
0005s: -0.961525  
0006s: -0.961739  
0007s: -0.961354  
0008s: -0.961340  
0009s: -0.965418  
0010s: -0.963300  
0011s: -0.963808  
0012s: -0.963719  
0013s: -0.963851  
0014s: -0.965026  
0015s: -0.964446  
0016s: -0.965786  
0017s: -0.965304  
0018s: -0.964718  
0019s: -0.961654  
0020s: -0.961241  
0021s: -0.961948  
0022s: -0.961304  
0023s: -0.961530  
0024s: -0.963077  
0025s: -0.964360  
0026s: -0.963420  
0027s: -0.963769  
0028s: -0.963560  
0029s: -0.964639  
0030s: -0.964457  
0031s: -0.964557  
0032s: -0.966118  
0033s: -0.965591  
0034s: -0.963201  
0035s: -0.961457  
0036s: -0.961535  
0037s: -0.961688  
0038s: -0.961497  
0039s: -0.961539  
0040s: -0.964309  
0041s: -0.963699  
0042s: -0.963570  
0043s: -0.963604  
0044s: -0.963641  
0045s: -0.964509  
0046s: -0.964849  
0047s: -0.965200  
0048s: -0.965559  
0049s: -0.966129  
0050s: -0.961770  
0051s: -0.961570  
0052s: -0.961566  
0053s: -0.961721  
0054s: -0.961379  
0055s: -0.960889  
0056s: -0.965594  
0057s: -0.963357  
0058s: -0.963758  
0059s: -0.963670  
0060s: -0.963793  
0061s: -0.964952  
0062s: -0.964231  
0063s: -0.965989  
0064s: -0.965301  
0065s: -0.965201  
0066s: -0.961618  
0067s: -0.961269  
0068s: -0.961947  
0069s: -0.961295  
0070s: -0.961613  
0071s: -0.962670  
0072s: -0.964607  
0073s: -0.963266  
0074s: -0.963926  
0075s: -0.963389  
0076s: -0.964030  
0077s: -0.965061  
0078s: -0.964484  
0079s: -0.966070  
0080s: -0.965563  
0081s: -0.963581  
0082s: -0.961897  
0083s: -0.961150  
0084s: -0.961959  
0085s: -0.961220  
0086s: -0.961334  
0087s: -0.964121  
0088s: -0.963793  
0089s: -0.963409  
0090s: -0.963613  
0091s: -0.963717  
0092s: -0.964640  
0093s: -0.964595  
0094s: -0.965231  
0095s: -0.965574  
0096s: -0.966101  
0097s: -0.962245  
0098s: -0.961497  
0099s: -0.961664  
0100s: -0.961629  
0101s: -0.961377  
0102s: -0.960809  
0103s: -0.965427  
0104s: -0.963516  
0105s: -0.963585  
0106s: -0.963682  
0107s: -0.963716  
0108s: -0.964888  
0109s: -0.964383  
0110s: -0.965843  
0111s: -0.965748  
0112s: -0.965250  
0113s: -0.761573  
0114s: -0.761302  
0115s: -0.761839  
0116s: -0.761363  
0117s: -0.761656  
0118s: -0.762163  
0119s: -0.764443  
0120s: -0.763556  
0121s: -0.763556  
0122s: -0.763821  
0123s: -0.763907  
0124s: -0.765056  
0125s: -0.764584  
0126s: -0.765952  
0127s: -0.765511  
0128s: -0.963968  
0129s: -0.961948  
0130s: -0.961137  
0131s: -0.961888  
0132s: -0.961209  
0133s: -0.961349  
0134s: -0.963857  
0135s: -0.963826  
0136s: -0.963300  
0137s: -0.963753  
0138s: -0.963714  
0139s: -0.964523  
0140s: -0.964611  
0141s: -0.965248  
0142s: -0.965651  
0143s: -0.965975  
0144s: -0.962673  
0145s: -0.961477  
0146s: -0.961579  
0147s: -0.961685  
0148s: -0.961381  
0149s: -0.960947  
0150s: -0.965065  
0151s: -0.963527  
0152s: -0.963557  
0153s: -0.963772  
0154s: -0.963580  
0155s: -0.964842  
0156s: -0.964840  
0157s: -0.965447  
0158s: -0.965677  
0159s: -0.965679  
0160s: -0.961508  
0161s: -0.961344  
0162s: -0.961442  
0163s: -0.961704  
0164s: -0.961240  
0165s: -0.961882  
0166s: -0.965012  
0167s: -0.963371  
0168s: -0.963751  
0169s: -0.963775  
0170s: -0.963883  
0171s: -0.965069  
0172s: -0.964578  
0173s: -0.965833  
0174s: -0.965434  
0175s: -0.969900  
0176s: -0.977437  
0177s: -0.977724  
0178s: -0.976862  
0179s: -0.977758  
0180s: -0.977503  
0181s: -0.977288  
0182s: -0.977971  
0183s: -0.977648  
        `;
        const infectedData = infectedRawData.trim().split('\n').map(line => {
            const [time, value] = line.split(': ');
            return { time, value: parseFloat(value) };
        });
        const infectedValues = infectedData.map(item => item.value);
        const infectedTimes = infectedData.map(item => item.time);
        const infectedAvg = infectedValues.reduce((a, b) => a + b, 0) / infectedValues.length;
        const infectedMin = Math.min(...infectedValues);
        const infectedMax = Math.max(...infectedValues);
        document.getElementById('infectedAvg').textContent = infectedAvg.toFixed(6);
        document.getElementById('infectedMin').textContent = infectedMin.toFixed(6);
        document.getElementById('infectedMax').textContent = infectedMax.toFixed(6);

        // Chart 1: Not Infected
        const notInfectedCtx = document.getElementById('notInfectedChart').getContext('2d');
        new Chart(notInfectedCtx, {
            type: 'line',
            data: {
                labels: notInfectedTimes,
                datasets: [{
                    label: 'Vibration',
                    data: notInfectedValues,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Vibration Value'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Time (s)'
                        }
                    }
                }
            }
        });

        // Chart 2: Infected
        const infectedCtx = document.getElementById('infectedChart').getContext('2d');
        new Chart(infectedCtx, {
            type: 'line',
            data: {
                labels: infectedTimes,
                datasets: [{
                    label: 'Vibration',
                    data: infectedValues,
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Vibration Value'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Time (s)'
                        }
                    }
                }
            }
        });

        // Chart 3: Comparison
        const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
        new Chart(comparisonCtx, {
            type: 'line',
            data: {
                labels: [...new Set([...notInfectedTimes, ...infectedTimes])].sort(), // Combine and sort times
                datasets: [
                    {
                        label: 'Not Infected',
                        data: notInfectedData.reduce((acc, curr) => {
                            acc[curr.time] = curr.value;
                            return acc;
                        }, {}),
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Infected',
                        data: infectedData.reduce((acc, curr) => {
                            acc[curr.time] = curr.value;
                            return acc;
                        }, {}),
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Vibration Value'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Time (s)'
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                }
            }
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>